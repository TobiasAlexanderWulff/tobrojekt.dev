---
import Base from "~/layouts/Base.astro";
import { getCollection } from 'astro:content';

const tags = await getCollection('tags');
const projects = await getCollection('projects');

const counts = Object.fromEntries(
  tags.map((t) => [t.data.id, projects.filter((p) => (p.data.tags ?? []).includes(t.data.id)).length])
);
---
<Base title="Tags â€“ tobrojekt.dev" description="Browse projects by tag">
  <section class="container py-10">
    <h1 class="text-3xl font-bold mb-6">Tags</h1>
    <ul class="flex flex-wrap gap-3">
      {tags.map((t) => (
        <li>
          <a href={`/tags/${t.data.id}`} class="px-3 py-1 rounded border hover:bg-slate-50">
            {t.data.label} <span class="text-slate-500">({counts[t.data.id] ?? 0})</span>
          </a>
        </li>
      ))}
    </ul>
  </section>
</Base>

